# H∆Ø·ªöNG D·∫™N CHI TI·∫æT: CH·ª®C NƒÇNG GI·ªé H√ÄNG B·∫∞NG REDUX

## üìã M·ª§C L·ª§C

1. [T·ªïng quan](#t·ªïng-quan)
2. [B∆∞·ªõc 1: C√†i ƒë·∫∑t Redux Toolkit](#b∆∞·ªõc-1-c√†i-ƒë·∫∑t-redux-toolkit)
3. [B∆∞·ªõc 2: T·∫°o Redux Store v√† Cart Slice](#b∆∞·ªõc-2-t·∫°o-redux-store-v√†-cart-slice)
4. [B∆∞·ªõc 3: T√≠ch h·ª£p Redux Provider](#b∆∞·ªõc-3-t√≠ch-h·ª£p-redux-provider)
5. [B∆∞·ªõc 4: T·∫°o trang chi ti·∫øt s·∫£n ph·∫©m](#b∆∞·ªõc-4-t·∫°o-trang-chi-ti·∫øt-s·∫£n-ph·∫©m)
6. [B∆∞·ªõc 5: T·∫°o trang gi·ªè h√†ng](#b∆∞·ªõc-5-t·∫°o-trang-gi·ªè-h√†ng)
7. [B∆∞·ªõc 6: C·∫≠p nh·∫≠t Header](#b∆∞·ªõc-6-c·∫≠p-nh·∫≠t-header)
8. [B∆∞·ªõc 7: LocalStorage Persistence](#b∆∞·ªõc-7-localstorage-persistence)
9. [Ki·∫øn tr√∫c t·ªïng th·ªÉ](#ki·∫øn-tr√∫c-t·ªïng-th·ªÉ)

---

## T·ªîNG QUAN

Ch·ª©c nƒÉng gi·ªè h√†ng ƒë∆∞·ª£c x√¢y d·ª±ng b·∫±ng **Redux Toolkit** v·ªõi c√°c t√≠nh nƒÉng:
- ‚úÖ Th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng
- ‚úÖ TƒÉng/gi·∫£m s·ªë l∆∞·ª£ng s·∫£n ph·∫©m
- ‚úÖ X√≥a s·∫£n ph·∫©m kh·ªèi gi·ªè h√†ng
- ‚úÖ Hi·ªÉn th·ªã badge s·ªë l∆∞·ª£ng s·∫£n ph·∫©m tr√™n icon gi·ªè h√†ng
- ‚úÖ L∆∞u tr·ªØ gi·ªè h√†ng v√†o localStorage (kh√¥ng m·∫•t d·ªØ li·ªáu khi F5)
- ‚úÖ T·ª± ƒë·ªông c·ªông d·ªìn s·ªë l∆∞·ª£ng khi th√™m s·∫£n ph·∫©m tr√πng

---

## B∆Ø·ªöC 1: C√ÄI ƒê·∫∂T REDUX TOOLKIT

### 1.1. M·ªü Terminal trong project

```bash
# Di chuy·ªÉn v√†o th∆∞ m·ª•c project (n·∫øu ch∆∞a ·ªü trong ƒë√≥)
cd x:\code_cong_ty\test1-cartbage-redux\giao_dien_tiki-main\tiki-clone
```

### 1.2. Ch·∫°y l·ªánh c√†i ƒë·∫∑t

```bash
npm install @reduxjs/toolkit react-redux
```

**Gi·∫£i th√≠ch t·ª´ng ph·∫ßn:**
- `npm install`: L·ªánh c√†i ƒë·∫∑t package trong Node.js
- `@reduxjs/toolkit`: Package Redux Toolkit ch√≠nh th·ª©c
- `react-redux`: Package k·∫øt n·ªëi Redux v·ªõi React

### 1.3. Packages ƒë∆∞·ª£c c√†i ƒë·∫∑t:
- **@reduxjs/toolkit**: Th∆∞ vi·ªán Redux ch√≠nh th·ª©c, ƒë∆°n gi·∫£n h√≥a vi·ªác setup Redux
  - Bao g·ªìm: createSlice, configureStore, createAsyncThunk
  - T·ª± ƒë·ªông setup Redux DevTools
  - T√≠ch h·ª£p Immer ƒë·ªÉ mutate state an to√†n
  
- **react-redux**: K·∫øt n·ªëi Redux v·ªõi React components
  - Provider: Cung c·∫•p store cho to√†n b·ªô app
  - useSelector: Hook ƒë·ªÉ ƒë·ªçc state
  - useDispatch: Hook ƒë·ªÉ dispatch actions

### 1.4. Ki·ªÉm tra ƒë√£ c√†i ƒë·∫∑t th√†nh c√¥ng

M·ªü file `package.json` v√† ki·ªÉm tra:

```json
"dependencies": {
  "@reduxjs/toolkit": "^2.x.x",
  "react-redux": "^9.x.x",
  // ... c√°c package kh√°c
}
```

---

## B∆Ø·ªöC 2: T·∫†O REDUX STORE V√Ä CART SLICE

### 2.1. T·∫°o th∆∞ m·ª•c `store`

```bash
# T·∫°o th∆∞ m·ª•c store trong src
mkdir src/store
```

### 2.2. T·∫°o file `src/store/cartSlice.js`

**CODE ƒê·∫¶Y ƒê·ª¶ V·ªöI GI·∫¢I TH√çCH T·ª™NG D√íNG:**

```javascript
// ============================================
// IMPORT REDUX TOOLKIT
// ============================================
import { createSlice } from "@reduxjs/toolkit";
// createSlice: Function t·∫°o slice (m·ªôt ph·∫ßn c·ªßa Redux store)
// Slice = state + reducers + actions


// ============================================
// FUNCTION LOAD GI·ªé H√ÄNG T·ª™ LOCALSTORAGE
// ============================================
const loadCartFromStorage = () => {
  try {
    // ƒê·ªçc d·ªØ li·ªáu t·ª´ localStorage v·ªõi key "tikiCart"
    const savedCart = localStorage.getItem("tikiCart");
    
    // N·∫øu c√≥ d·ªØ li·ªáu ƒë√£ l∆∞u
    if (savedCart) {
      // Parse JSON string th√†nh JavaScript object
      return JSON.parse(savedCart);
    }
  } catch (error) {
    // N·∫øu c√≥ l·ªói (v√≠ d·ª•: JSON kh√¥ng h·ª£p l·ªá)
    console.error("Error loading cart from localStorage:", error);
  }
  
  // N·∫øu kh√¥ng c√≥ d·ªØ li·ªáu ho·∫∑c c√≥ l·ªói, tr·∫£ v·ªÅ state m·∫∑c ƒë·ªãnh
  return {
    items: [],           // M·∫£ng r·ªóng - ch∆∞a c√≥ s·∫£n ph·∫©m
    totalQuantity: 0,    // T·ªïng s·ªë l∆∞·ª£ng = 0
  };
};


// ============================================
// FUNCTION L∆ØU GI·ªé H√ÄNG V√ÄO LOCALSTORAGE
// ============================================
const saveCartToStorage = (state) => {
  try {
    // Chuy·ªÉn ƒë·ªïi state (object) th√†nh JSON string
    // L∆∞u v√†o localStorage v·ªõi key "tikiCart"
    localStorage.setItem("tikiCart", JSON.stringify(state));
  } catch (error) {
    // N·∫øu c√≥ l·ªói (v√≠ d·ª•: localStorage ƒë·∫ßy)
    console.error("Error saving cart to localStorage:", error);
  }
};


// ============================================
// T·∫†O CART SLICE
// ============================================
const cartSlice = createSlice({
  // T√™n c·ªßa slice - s·∫Ω ƒë∆∞·ª£c d√πng trong Redux DevTools
  name: "cart",
  
  // State kh·ªüi t·∫°o - load t·ª´ localStorage
  initialState: loadCartFromStorage(),
  
  // C√°c reducers (functions x·ª≠ l√Ω actions)
  reducers: {
    
    // ========================================
    // ACTION: TH√äM S·∫¢N PH·∫®M V√ÄO GI·ªé H√ÄNG
    // ========================================
    addToCart: (state, action) => {
      // action.payload = d·ªØ li·ªáu g·ª≠i k√®m khi dispatch action
      // V√≠ d·ª•: { id: 1, name: "iPhone", price: 1000, quantity: 2 }
      const newItem = action.payload;
      
      // T√¨m xem s·∫£n ph·∫©m ƒë√£ t·ªìn t·∫°i trong gi·ªè ch∆∞a
      // find() tr·∫£ v·ªÅ item ƒë·∫ßu ti√™n c√≥ id tr√πng, ho·∫∑c undefined
      const existingItem = state.items.find(
        (item) => item.id === newItem.id
      );

      // N·∫øu s·∫£n ph·∫©m ƒê√É C√ì trong gi·ªè
      if (existingItem) {
        // C·ªòNG TH√äM s·ªë l∆∞·ª£ng v√†o s·∫£n ph·∫©m ƒë√£ c√≥
        existingItem.quantity += newItem.quantity;
        
        // C·∫≠p nh·∫≠t t·ªïng s·ªë l∆∞·ª£ng
        state.totalQuantity += newItem.quantity;
      } 
      // N·∫øu s·∫£n ph·∫©m CH∆ØA C√ì trong gi·ªè
      else {
        // TH√äM M·ªöI s·∫£n ph·∫©m v√†o m·∫£ng items
        state.items.push({
          id: newItem.id,                       // ID s·∫£n ph·∫©m
          name: newItem.name,                   // T√™n s·∫£n ph·∫©m
          image: newItem.image,                 // URL h√¨nh ·∫£nh
          price: newItem.price,                 // Gi√° sau gi·∫£m
          originalPrice: newItem.originalPrice, // Gi√° g·ªëc
          discount: newItem.discount,           // % gi·∫£m gi√°
          quantity: newItem.quantity,           // S·ªë l∆∞·ª£ng
        });
        
        // C·∫≠p nh·∫≠t t·ªïng s·ªë l∆∞·ª£ng
        state.totalQuantity += newItem.quantity;
      }
      
      // L∆∞u state m·ªõi v√†o localStorage
      saveCartToStorage(state);
    },
    
    
    // ========================================
    // ACTION: X√ìA S·∫¢N PH·∫®M KH·ªéI GI·ªé H√ÄNG
    // ========================================
    removeFromCart: (state, action) => {
      // action.payload = id c·ªßa s·∫£n ph·∫©m c·∫ßn x√≥a
      // V√≠ d·ª•: 5
      const id = action.payload;
      
      // T√¨m s·∫£n ph·∫©m c·∫ßn x√≥a
      const existingItem = state.items.find((item) => item.id === id);

      // N·∫øu t√¨m th·∫•y s·∫£n ph·∫©m
      if (existingItem) {
        // TR·ª™ t·ªïng s·ªë l∆∞·ª£ng ƒëi s·ªë l∆∞·ª£ng c·ªßa s·∫£n ph·∫©m b·ªã x√≥a
        state.totalQuantity -= existingItem.quantity;
        
        // L·ªåC B·ªé s·∫£n ph·∫©m kh·ªèi m·∫£ng (gi·ªØ l·∫°i c√°c item kh√°c)
        // filter() t·∫°o m·∫£ng m·ªõi kh√¥ng ch·ª©a item c√≥ id tr√πng
        state.items = state.items.filter((item) => item.id !== id);
      }
      
      // L∆∞u state m·ªõi v√†o localStorage
      saveCartToStorage(state);
    },
    
    
    // ========================================
    // ACTION: C·∫¨P NH·∫¨T S·ªê L∆Ø·ª¢NG S·∫¢N PH·∫®M
    // ========================================
    updateQuantity: (state, action) => {
      // action.payload = { id: 5, quantity: 10 }
      const { id, quantity } = action.payload;
      
      // T√¨m s·∫£n ph·∫©m c·∫ßn c·∫≠p nh·∫≠t
      const existingItem = state.items.find((item) => item.id === id);

      // N·∫øu t√¨m th·∫•y s·∫£n ph·∫©m
      if (existingItem) {
        // T√≠nh CH√äNH L·ªÜCH gi·ªØa s·ªë l∆∞·ª£ng m·ªõi v√† c≈©
        // V√≠ d·ª•: quantity m·ªõi = 10, c≈© = 3 ‚Üí diff = 7
        const diff = quantity - existingItem.quantity;
        
        // C·∫¨P NH·∫¨T s·ªë l∆∞·ª£ng s·∫£n ph·∫©m
        existingItem.quantity = quantity;
        
        // C·∫≠p nh·∫≠t t·ªïng s·ªë l∆∞·ª£ng theo ch√™nh l·ªách
        state.totalQuantity += diff;
      }
      
      // L∆∞u state m·ªõi v√†o localStorage
      saveCartToStorage(state);
    },
    
    
    // ========================================
    // ACTION: X√ìA TO√ÄN B·ªò GI·ªé H√ÄNG
    // ========================================
    clearCart: (state) => {
      // Reset m·∫£ng items v·ªÅ r·ªóng
      state.items = [];
      
      // Reset t·ªïng s·ªë l∆∞·ª£ng v·ªÅ 0
      state.totalQuantity = 0;
      
      // L∆∞u state r·ªóng v√†o localStorage
      saveCartToStorage(state);
    },
  },
});


// ============================================
// EXPORT ACTIONS V√Ä REDUCER
// ============================================

// Export c√°c actions ƒë·ªÉ d√πng trong components
// V√≠ d·ª•: dispatch(addToCart({...}))
export const { addToCart, removeFromCart, updateQuantity, clearCart } =
  cartSlice.actions;

// Export reducer ƒë·ªÉ ƒëƒÉng k√Ω v√†o store
export default cartSlice.reducer;
```

### 2.3. Gi·∫£i th√≠ch c·∫•u tr√∫c State

```javascript
// State c·ªßa gi·ªè h√†ng c√≥ d·∫°ng:
{
  items: [
    {
      id: 1,                    // ID duy nh·∫•t c·ªßa s·∫£n ph·∫©m
      name: "iPhone 15",        // T√™n s·∫£n ph·∫©m
      image: "url_hinh_anh",    // URL h√¨nh ·∫£nh
      price: 23490000,          // Gi√° sau gi·∫£m (VND)
      originalPrice: 33490000,  // Gi√° g·ªëc (VND)
      discount: 30,             // % gi·∫£m gi√°
      quantity: 2               // S·ªë l∆∞·ª£ng trong gi·ªè
    },
    {
      id: 5,
      name: "S√°ch ƒê·∫Øc Nh√¢n T√¢m",
      // ...
      quantity: 1
    }
  ],
  totalQuantity: 3  // T·ªïng: 2 + 1 = 3
}
```

#### **C·∫•u tr√∫c State:**
```javascript
{
  items: [
    {
      id: 1,
      name: "S·∫£n ph·∫©m A",
      image: "url_h√¨nh_·∫£nh",
      price: 100000,
      originalPrice: 120000,
      discount: 17,
      quantity: 2
    }
  ],
  totalQuantity: 5  // T·ªïng s·ªë l∆∞·ª£ng c·ªßa T·∫§T C·∫¢ s·∫£n ph·∫©m
}
```

#### **C√°c Actions (Reducers):**

##### 1. **addToCart** - Th√™m s·∫£n ph·∫©m v√†o gi·ªè
```javascript
addToCart: (state, action) => {
  const newItem = action.payload;
  const existingItem = state.items.find((item) => item.id === newItem.id);

  if (existingItem) {
    // S·∫£n ph·∫©m ƒë√£ c√≥ ‚Üí TƒÇNG S·ªê L∆Ø·ª¢NG
    existingItem.quantity += newItem.quantity;
    state.totalQuantity += newItem.quantity;
  } else {
    // S·∫£n ph·∫©m ch∆∞a c√≥ ‚Üí TH√äM M·ªöI
    state.items.push({
      id: newItem.id,
      name: newItem.name,
      image: newItem.image,
      price: newItem.price,
      originalPrice: newItem.originalPrice,
      discount: newItem.discount,
      quantity: newItem.quantity,
    });
    state.totalQuantity += newItem.quantity;
  }
  
  saveCartToStorage(state); // L∆∞u v√†o localStorage
}
```

**Logic:**
- Ki·ªÉm tra s·∫£n ph·∫©m ƒë√£ t·ªìn t·∫°i ch∆∞a (d·ª±a v√†o `id`)
- N·∫øu **c√≥ r·ªìi**: C·ªông d·ªìn s·ªë l∆∞·ª£ng
- N·∫øu **ch∆∞a c√≥**: Th√™m s·∫£n ph·∫©m m·ªõi v√†o m·∫£ng `items`
- C·∫≠p nh·∫≠t `totalQuantity`

##### 2. **removeFromCart** - X√≥a s·∫£n ph·∫©m kh·ªèi gi·ªè
```javascript
removeFromCart: (state, action) => {
  const id = action.payload;
  const existingItem = state.items.find((item) => item.id === id);

  if (existingItem) {
    state.totalQuantity -= existingItem.quantity;
    state.items = state.items.filter((item) => item.id !== id);
  }
  
  saveCartToStorage(state);
}
```

**Logic:**
- T√¨m s·∫£n ph·∫©m theo `id`
- Tr·ª´ `totalQuantity` ƒëi s·ªë l∆∞·ª£ng c·ªßa s·∫£n ph·∫©m ƒë√≥
- Lo·∫°i b·ªè s·∫£n ph·∫©m kh·ªèi m·∫£ng `items`

##### 3. **updateQuantity** - C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng s·∫£n ph·∫©m
```javascript
updateQuantity: (state, action) => {
  const { id, quantity } = action.payload;
  const existingItem = state.items.find((item) => item.id === id);

  if (existingItem) {
    const diff = quantity - existingItem.quantity;
    existingItem.quantity = quantity;
    state.totalQuantity += diff;
  }
  
  saveCartToStorage(state);
}
```

**Logic:**
- T√≠nh ch√™nh l·ªách gi·ªØa s·ªë l∆∞·ª£ng m·ªõi v√† c≈©
- C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng s·∫£n ph·∫©m
- C·∫≠p nh·∫≠t `totalQuantity` theo ch√™nh l·ªách

##### 4. **clearCart** - X√≥a to√†n b·ªô gi·ªè h√†ng
```javascript
clearCart: (state) => {
  state.items = [];
  state.totalQuantity = 0;
  
  saveCartToStorage(state);
}
```

### 2.4. T·∫°o file `src/store/store.js`

**CODE ƒê·∫¶Y ƒê·ª¶ V·ªöI GI·∫¢I TH√çCH T·ª™NG D√íNG:**

```javascript
// ============================================
// IMPORT REDUX TOOLKIT
// ============================================
import { configureStore } from "@reduxjs/toolkit";
// configureStore: Function t·∫°o Redux store
// T·ª± ƒë·ªông setup Redux DevTools, middleware, v.v.

// Import reducer t·ª´ cartSlice
import cartReducer from "./cartSlice";


// ============================================
// T·∫†O REDUX STORE
// ============================================
const store = configureStore({
  // ƒêƒÉng k√Ω c√°c reducers
  reducer: {
    // Key "cart" ‚Üí State s·∫Ω c√≥ d·∫°ng: { cart: {...} }
    // Value: cartReducer ‚Üí X·ª≠ l√Ω c√°c actions li√™n quan ƒë·∫øn gi·ªè h√†ng
    cart: cartReducer,
    
    // C√≥ th·ªÉ th√™m c√°c reducer kh√°c ·ªü ƒë√¢y:
    // user: userReducer,
    // products: productsReducer,
  },
});

// Export store ƒë·ªÉ d√πng trong Provider
export default store;
```

**Gi·∫£i th√≠ch:**
- `configureStore`: 
  - T·∫°o Redux store v·ªõi c·∫•u h√¨nh t·ª± ƒë·ªông
  - T·ª± ƒë·ªông th√™m Redux Thunk middleware
  - T·ª± ƒë·ªông k·∫øt n·ªëi v·ªõi Redux DevTools Extension
  
- `cart: cartReducer`: 
  - Key `cart` ‚Üí Truy c·∫≠p state b·∫±ng `state.cart`
  - Value `cartReducer` ‚Üí X·ª≠ l√Ω c√°c actions t·ª´ cartSlice
  
- State s·∫Ω c√≥ d·∫°ng: 
  ```javascript
  {
    cart: {
      items: [...],
      totalQuantity: 0
    }
  }
  ```

### 2.5. C·∫•u tr√∫c th∆∞ m·ª•c sau b∆∞·ªõc n√†y

```
src/
‚îú‚îÄ‚îÄ store/
‚îÇ   ‚îú‚îÄ‚îÄ cartSlice.js    ‚Üê Redux slice cho gi·ªè h√†ng
‚îÇ   ‚îî‚îÄ‚îÄ store.js        ‚Üê Redux store configuration
‚îú‚îÄ‚îÄ components/
‚îú‚îÄ‚îÄ pages/
‚îî‚îÄ‚îÄ ...
```

---

## B∆Ø·ªöC 3: T√çCH H·ª¢P REDUX PROVIDER

### 3.1. M·ªü file `src/index.js`

### 3.2. C·∫≠p nh·∫≠t code v·ªõi gi·∫£i th√≠ch t·ª´ng d√≤ng

**CODE ƒê·∫¶Y ƒê·ª¶:**

```javascript
// ============================================
// IMPORT REACT
// ============================================
import React from "react";
// React: Th∆∞ vi·ªán React core

import ReactDOM from "react-dom/client";
// ReactDOM: ƒê·ªÉ render React app v√†o DOM


// ============================================
// IMPORT REDUX
// ============================================
import { Provider } from "react-redux";
// Provider: Component b·ªçc app ƒë·ªÉ cung c·∫•p Redux store cho t·∫•t c·∫£ component con

import store from "./store/store";
// store: Redux store ƒë√£ t·∫°o ·ªü b∆∞·ªõc 2


// ============================================
// IMPORT APP V√Ä CSS
// ============================================
import App from "./App";
// App: Root component c·ªßa ·ª©ng d·ª•ng

import "./index.css";
// CSS to√†n c·ª•c


// ============================================
// T·∫†O ROOT V√Ä RENDER APP
// ============================================

// T·∫°o root t·ª´ element c√≥ id="root" trong public/index.html
const root = ReactDOM.createRoot(document.getElementById("root"));

// Render ·ª©ng d·ª•ng
root.render(
  // Provider b·ªçc App ƒë·ªÉ cung c·∫•p Redux store
  <Provider store={store}>
    {/* 
      T·∫•t c·∫£ component b√™n trong Provider ƒë·ªÅu c√≥ th·ªÉ:
      - ƒê·ªçc state: useSelector(state => state.cart)
      - Dispatch actions: useDispatch()
    */}
    <App />
  </Provider>
);
```

### 3.3. Gi·∫£i th√≠ch chi ti·∫øt

#### **Provider l√† g√¨?**
- `Provider` l√† m·ªôt React component t·ª´ `react-redux`
- N√≥ s·ª≠ d·ª•ng React Context ƒë·ªÉ truy·ªÅn `store` xu·ªëng t·∫•t c·∫£ component con
- **B·∫ÆT BU·ªòC** ph·∫£i b·ªçc `<Provider>` ·ªü root level

#### **C√°ch ho·∫°t ƒë·ªông:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   <Provider store={store}>  ‚îÇ  ‚Üê Cung c·∫•p store
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ         <App />             ‚îÇ
‚îÇ           ‚îÇ                 ‚îÇ
‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
‚îÇ    ‚îÇ             ‚îÇ         ‚îÇ
‚îÇ <Header />  <HomePage />   ‚îÇ  ‚Üê T·∫•t c·∫£ ƒë·ªÅu truy c·∫≠p ƒë∆∞·ª£c store
‚îÇ    ‚îÇ             ‚îÇ         ‚îÇ
‚îÇ    ‚îÇ       <CartPage />    ‚îÇ
‚îÇ    ‚îÇ                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### **N·∫øu kh√¥ng c√≥ Provider:**
```javascript
// ‚ùå L·ªñI - Kh√¥ng th·ªÉ d√πng useSelector ho·∫∑c useDispatch
function Header() {
  const cart = useSelector(state => state.cart); // ERROR!
}
```

#### **V·ªõi Provider:**
```javascript
// ‚úì OK - Ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng
function Header() {
  const cart = useSelector(state => state.cart); // ‚úì OK
}
```

### 3.4. Ki·ªÉm tra Redux DevTools

1. C√†i extension **Redux DevTools** trong Chrome/Firefox
2. Ch·∫°y app: `npm start`
3. M·ªü DevTools (F12) ‚Üí Tab "Redux"
4. Xem state hi·ªán t·∫°i:
   ```json
   {
     "cart": {
       "items": [],
       "totalQuantity": 0
     }
   }
   ```

---

## B∆Ø·ªöC 4: T·∫†O TRANG CHI TI·∫æT S·∫¢N PH·∫®M

### 4.1. T·∫°o file `src/pages/ProductDetailPage.jsx`

### 4.2. Import c√°c th∆∞ vi·ªán v√† d·ªØ li·ªáu c·∫ßn thi·∫øt

**CODE ƒê·∫¶Y ƒê·ª¶ V·ªöI GI·∫¢I TH√çCH:**

```javascript
// ============================================
// IMPORT REACT V√Ä HOOKS
// ============================================
import React, { useState } from "react";
// React: Th∆∞ vi·ªán core
// useState: Hook qu·∫£n l√Ω state c·ª•c b·ªô (s·ªë l∆∞·ª£ng, notification)

import { useParams } from "react-router-dom";
// useParams: Hook l·∫•y tham s·ªë t·ª´ URL
// V√≠ d·ª•: URL l√† /product/5 ‚Üí useParams() tr·∫£ v·ªÅ { productId: "5" }


// ============================================
// IMPORT REDUX HOOKS V√Ä ACTIONS
// ============================================
import { useDispatch } from "react-redux";
// useDispatch: Hook ƒë·ªÉ g·ª≠i actions ƒë·∫øn Redux store

import { addToCart } from "../store/cartSlice";
// addToCart: Action creator t·ª´ cartSlice ƒë·ªÉ th√™m s·∫£n ph·∫©m v√†o gi·ªè


// ============================================
// IMPORT C√ÅC DATA SOURCES
// ============================================
import suggestedProductsData from "../data/suggestedProductsData";
import topDealsData from "../data/topDealsData";
import flashSaleData from "../data/flashSaleData";
import hotInternationalData from "../data/hotInternationalData";
import youMayLikeData from "../data/youMayLikeData";
// T·∫•t c·∫£ c√°c ngu·ªìn d·ªØ li·ªáu s·∫£n ph·∫©m c√≥ th·ªÉ c√≥


// ============================================
// IMPORT CSS
// ============================================
import "./ProductDetailPage.css";
```

### 4.3. Function t√¨m s·∫£n ph·∫©m t·ª´ nhi·ªÅu ngu·ªìn

```javascript
// ============================================
// FUNCTION T√åM S·∫¢N PH·∫®M T·ª™ NHI·ªÄU DATA SOURCES
// ============================================
const findProduct = (id) => {
  // Chuy·ªÉn id t·ª´ string sang number
  // V√¨ URL params lu√¥n l√† string, nh∆∞ng data d√πng number
  const numId = parseInt(id);
  
  // ========================================
  // B∆Ø·ªöC 1: T√¨m trong Suggested Products
  // ========================================
  let product = suggestedProductsData.find((p) => p.id === numId);
  // find() tr·∫£ v·ªÅ s·∫£n ph·∫©m ƒë·∫ßu ti√™n c√≥ id kh·ªõp, ho·∫∑c undefined
  
  // N·∫øu t√¨m th·∫•y, return lu√¥n (kh√¥ng c·∫ßn t√¨m ti·∫øp)
  if (product) return product;
  
  
  // ========================================
  // B∆Ø·ªöC 2: T√¨m trong Top Deals
  // ========================================
  const topDeal = topDealsData.find((p) => p.id === numId);
  if (topDeal) {
    // Top Deals c√≥ c·∫•u tr√∫c kh√°c, c·∫ßn MAP sang format chu·∫©n
    return {
      id: topDeal.id,                  // ID gi·ªØ nguy√™n
      name: topDeal.title,             // title ‚Üí name
      image: topDeal.image,            // image gi·ªØ nguy√™n
      price: topDeal.price,            // price gi·ªØ nguy√™n
      originalPrice: topDeal.originalPrice,
      discount: topDeal.discount,
      rating: topDeal.rating,
      soldCount: topDeal.soldCount,
      badgeIcon: topDeal.imageBadges,  // imageBadges ‚Üí badgeIcon
    };
  }
  
  
  // ========================================
  // B∆Ø·ªöC 3: T√¨m trong Flash Sale
  // ========================================
  const flashSale = flashSaleData.find((p) => p.id === numId);
  if (flashSale) {
    return {
      id: flashSale.id,
      name: flashSale.title,           // title ‚Üí name
      image: flashSale.image,
      price: flashSale.price,
      originalPrice: flashSale.originalPrice,
      discount: flashSale.discount,
      progressBarPercentage: flashSale.progressBarPercentage,
    };
  }
  
  
  // ========================================
  // B∆Ø·ªöC 4: T√¨m trong Hot International
  // ========================================
  const hotInternational = hotInternationalData.find((p) => p.id === numId);
  if (hotInternational) {
    return {
      id: hotInternational.id,
      name: hotInternational.title,     // title ‚Üí name
      image: hotInternational.image,
      price: hotInternational.price,
      originalPrice: hotInternational.originalPrice,
      discount: hotInternational.discount,
      rating: hotInternational.rating,
      soldCount: hotInternational.soldCount,
      freeShip: hotInternational.freeShip,
      badgeIcon: hotInternational.imageBadges,
    };
  }
  
  
  // ========================================
  // B∆Ø·ªöC 5: T√¨m trong You May Like
  // ========================================
  const youMayLike = youMayLikeData.find((p) => p.id === numId);
  if (youMayLike) {
    return {
      id: youMayLike.id,
      name: youMayLike.title,           // title ‚Üí name
      image: youMayLike.image,
      price: youMayLike.price,
      originalPrice: youMayLike.originalPrice,
      discount: youMayLike.discount,
      rating: youMayLike.rating,
      soldCount: youMayLike.soldCount,
      badgeIcon: youMayLike.imageBadges,
    };
  }
  
  // N·∫øu kh√¥ng t√¨m th·∫•y ·ªü b·∫•t k·ª≥ ngu·ªìn n√†o, return null
  return null;
};
```

**L√Ω do c·∫ßn function n√†y:**
- M·ªói data source c√≥ c·∫•u tr√∫c kh√°c nhau (`name` vs `title`, `badgeIcon` vs `imageBadges`)
- Nhi·ªÅu data sources c√≥ th·ªÉ c√≥ c√πng ID (v√≠ d·ª•: ID 1 ·ªü c·∫£ TopDeals v√† FlashSale)
- C·∫ßn t√¨m t·ª´ T·∫§T C·∫¢ ngu·ªìn v√† chu·∫©n h√≥a v·ªÅ m·ªôt format duy nh·∫•t

### 4.4. Component ch√≠nh v·ªõi Redux integration

```javascript
// ============================================
// PRODUCT DETAIL PAGE COMPONENT
// ============================================
function ProductDetailPage() {
  
  // ========================================
  // SETUP REDUX
  // ========================================
  const dispatch = useDispatch();
  // dispatch: Function ƒë·ªÉ g·ª≠i actions ƒë·∫øn Redux store
  // V√≠ d·ª•: dispatch(addToCart({...}))
  
  
  // ========================================
  // SETUP LOCAL STATE
  // ========================================
  const [quantity, setQuantity] = useState(1);
  // quantity: S·ªë l∆∞·ª£ng s·∫£n ph·∫©m ng∆∞·ªùi d√πng mu·ªën mua (m·∫∑c ƒë·ªãnh = 1)
  // setQuantity: Function ƒë·ªÉ c·∫≠p nh·∫≠t quantity
  
  const [notification, setNotification] = useState({
    show: false,      // C√≥ hi·ªÉn th·ªã notification kh√¥ng?
    message: "",      // N·ªôi dung th√¥ng b√°o
    type: "",         // "success" ho·∫∑c "warning"
  });
  
  
  // ========================================
  // L·∫§Y PRODUCT ID T·ª™ URL
  // ========================================
  const { productId } = useParams();
  // URL: /product/5 ‚Üí productId = "5"
  // URL: /product/123 ‚Üí productId = "123"
  
  
  // ========================================
  // T√åM TH√îNG TIN S·∫¢N PH·∫®M
  // ========================================
  const product = findProduct(productId);
  // G·ªçi function findProduct ƒë·ªÉ t√¨m s·∫£n ph·∫©m t·ª´ t·∫•t c·∫£ data sources
  
  // N·∫øu kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m
  if (!product) {
    return <div>Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m</div>;
  }
  
  
  // ========================================
  // T√çNH GI√Å SAU GI·∫¢M
  // ========================================
  const finalPrice = product.price || 
    (product.originalPrice * (100 - product.discount)) / 100;
  // N·∫øu ƒë√£ c√≥ price ‚Üí d√πng lu√¥n
  // N·∫øu ch∆∞a ‚Üí t√≠nh t·ª´ originalPrice v√† discount
  // V√≠ d·ª•: originalPrice=1000, discount=20 ‚Üí finalPrice = 1000*(100-20)/100 = 800
  
  
  // ========================================
  // HANDLER: GI·∫¢M S·ªê L∆Ø·ª¢NG
  // ========================================
  const handleDecrease = () => {
    // Ch·ªâ gi·∫£m n·∫øu quantity > 1 (kh√¥ng cho ph√©p = 0)
    if (quantity > 1) {
      setQuantity(quantity - 1);
    }
  };
  
  
  // ========================================
  // HANDLER: TƒÇNG S·ªê L∆Ø·ª¢NG
  // ========================================
  const handleIncrease = () => {
    setQuantity(quantity + 1);
    // Kh√¥ng gi·ªõi h·∫°n s·ªë l∆∞·ª£ng t·ªëi ƒëa (c√≥ th·ªÉ th√™m gi·ªõi h·∫°n n·∫øu c·∫ßn)
  };
  
  
  // ========================================
  // HANDLER: TH√äM V√ÄO GI·ªé H√ÄNG
  // ========================================
  const handleAddToCart = () => {
    // Dispatch action addToCart v·ªõi payload l√† th√¥ng tin s·∫£n ph·∫©m
    dispatch(
      addToCart({
        id: product.id,                      // ID s·∫£n ph·∫©m
        name: product.name,                  // T√™n
        image: product.image,                // H√¨nh ·∫£nh
        price: finalPrice,                   // Gi√° sau gi·∫£m
        originalPrice: product.originalPrice,// Gi√° g·ªëc
        discount: product.discount,          // % gi·∫£m gi√°
        quantity: quantity,                  // S·ªë l∆∞·ª£ng ƒë√£ ch·ªçn
      })
    );
    // Redux t·ª± ƒë·ªông:
    // 1. Nh·∫≠n action n√†y
    // 2. Ch·∫°y reducer addToCart trong cartSlice
    // 3. C·∫≠p nh·∫≠t state
    // 4. L∆∞u v√†o localStorage
    // 5. Trigger re-render cho t·∫•t c·∫£ components subscribe
    
    
    // Hi·ªÉn th·ªã notification th√†nh c√¥ng
    setNotification({
      show: true,
      message: "ƒê√£ th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng",
      type: "success",
    });
    
    // T·ª± ƒë·ªông ·∫©n notification sau 2 gi√¢y
    setTimeout(() => {
      setNotification({
        show: false,
        message: "",
        type: "",
      });
    }, 2000); // 2000ms = 2 gi√¢y
  };
  
  
  // ========================================
  // RENDER JSX
  // ========================================
  return (
    <div className="product-detail-page">
      {/* Notification popup */}
      {notification.show && (
        <div className={`add-to-cart-notification ${notification.type}`}>
          <div className="notification-content">
            <span className="notification-icon">
              {notification.type === "success" ? "‚úì" : "‚ìò"}
            </span>
            <span>{notification.message}</span>
          </div>
        </div>
      )}
      
      {/* H√¨nh ·∫£nh s·∫£n ph·∫©m */}
      <div className="product-image">
        <img src={product.image} alt={product.name} />
      </div>
      
      {/* Th√¥ng tin s·∫£n ph·∫©m */}
      <div className="product-info">
        <h1>{product.name}</h1>
        
        {/* Gi√° */}
        <div className="product-price">
          <span className="current-price">
            {finalPrice.toLocaleString("vi-VN")}‚Ç´
          </span>
          {product.originalPrice && (
            <span className="original-price">
              {product.originalPrice.toLocaleString("vi-VN")}‚Ç´
            </span>
          )}
        </div>
        
        {/* Ch·ªçn s·ªë l∆∞·ª£ng */}
        <div className="quantity-selector">
          <label>S·ªë l∆∞·ª£ng:</label>
          <div className="quantity-controls">
            <button onClick={handleDecrease}>-</button>
            <input type="number" value={quantity} readOnly />
            <button onClick={handleIncrease}>+</button>
          </div>
        </div>
        
        {/* N√∫t th√™m v√†o gi·ªè */}
        <button className="add-to-cart-btn" onClick={handleAddToCart}>
          Th√™m v√†o gi·ªè h√†ng
        </button>
      </div>
    </div>
  );
}

export default ProductDetailPage;
```

### 4.5. Lu·ªìng ho·∫°t ƒë·ªông

```
1. User click v√†o s·∫£n ph·∫©m ‚Üí URL: /product/5
                ‚Üì
2. useParams() l·∫•y productId = "5"
                ‚Üì
3. findProduct(5) t√¨m trong t·∫•t c·∫£ data sources
                ‚Üì
4. Hi·ªÉn th·ªã th√¥ng tin s·∫£n ph·∫©m
                ‚Üì
5. User ch·ªçn s·ªë l∆∞·ª£ng = 3
                ‚Üì
6. User click "Th√™m v√†o gi·ªè"
                ‚Üì
7. dispatch(addToCart({id:5, quantity:3, ...}))
                ‚Üì
8. Redux reducer x·ª≠ l√Ω ‚Üí C·∫≠p nh·∫≠t state.cart.items
                ‚Üì
9. L∆∞u v√†o localStorage
                ‚Üì
10. Hi·ªÉn th·ªã notification "ƒê√£ th√™m..."
                ‚Üì
11. T·∫•t c·∫£ components (Header badge) t·ª± ƒë·ªông re-render
```

---

## B∆Ø·ªöC 5: T·∫†O TRANG GI·ªé H√ÄNG

### 5.1. T·∫°o file `src/pages/CartPage.jsx`

### 5.2. Import c√°c th∆∞ vi·ªán c·∫ßn thi·∫øt

**CODE V·ªöI GI·∫¢I TH√çCH:**

```javascript
// ============================================
// IMPORT REACT
// ============================================
import React from "react";
// React: Th∆∞ vi·ªán core


// ============================================
// IMPORT REDUX HOOKS V√Ä ACTIONS
// ============================================
import { useSelector, useDispatch } from "react-redux";
// useSelector: Hook ƒë·ªÉ ƒê·ªåC data t·ª´ Redux store
// useDispatch: Hook ƒë·ªÉ G·ª¨I actions ƒë·∫øn Redux store

import { removeFromCart, updateQuantity } from "../store/cartSlice";
// removeFromCart: Action x√≥a s·∫£n ph·∫©m kh·ªèi gi·ªè
// updateQuantity: Action c·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng s·∫£n ph·∫©m


// ============================================
// IMPORT LINK ƒê·ªÇ ƒêI·ªÄU H∆Ø·ªöNG
// ============================================
import { Link } from "react-router-dom";
// Link: Component ƒë·ªÉ t·∫°o li√™n k·∫øt SPA (kh√¥ng reload trang)


// ============================================
// IMPORT CSS
// ============================================
import "./CartPage.css";
```

### 5.3. Component CartPage v·ªõi Redux integration

**CODE ƒê·∫¶Y ƒê·ª¶ V·ªöI GI·∫¢I TH√çCH T·ª™NG D√íNG:**

```javascript
// ============================================
// CART PAGE COMPONENT
// ============================================
function CartPage() {
  
  // ========================================
  // SETUP REDUX
  // ========================================
  const dispatch = useDispatch();
  // dispatch: Function ƒë·ªÉ g·ª≠i actions (removeFromCart, updateQuantity)
  
  
  // ========================================
  // L·∫§Y D·ªÆ LI·ªÜU T·ª™ REDUX STORE
  // ========================================
  const cartItems = useSelector((state) => state.cart.items);
  // cartItems: M·∫£ng c√°c s·∫£n ph·∫©m trong gi·ªè h√†ng
  // L·∫•y t·ª´: state.cart.items
  // V√≠ d·ª•: [
  //   { id: 1, name: "iPhone", quantity: 2, price: 20000000 },
  //   { id: 5, name: "S√°ch", quantity: 1, price: 100000 }
  // ]
  
  // Component s·∫Ω T·ª∞ ƒê·ªòNG RE-RENDER khi cartItems thay ƒë·ªïi
  // Kh√¥ng c·∫ßn setState hay forceUpdate
  
  
  // ========================================
  // T√çNH T·ªîNG TI·ªÄN GI·ªé H√ÄNG
  // ========================================
  const totalPrice = cartItems.reduce((total, item) => {
    // reduce: Duy·ªát qua t·∫•t c·∫£ items v√† t√≠nh t·ªïng
    // total: T·ªïng c·ªông d·ªìn (b·∫Øt ƒë·∫ßu t·ª´ 0)
    // item: T·ª´ng s·∫£n ph·∫©m trong gi·ªè
    
    return total + item.price * item.quantity;
    // C·ªông d·ªìn: gi√° √ó s·ªë l∆∞·ª£ng
    // V√≠ d·ª•:
    //   Item 1: 20,000,000 √ó 2 = 40,000,000
    //   Item 2: 100,000 √ó 1 = 100,000
    //   Total = 40,100,000
    
  }, 0); // 0: Gi√° tr·ªã kh·ªüi t·∫°o c·ªßa total
  
  
  // ========================================
  // HANDLER: TƒÇNG S·ªê L∆Ø·ª¢NG S·∫¢N PH·∫®M
  // ========================================
  const handleIncrease = (item) => {
    // Dispatch action updateQuantity v·ªõi s·ªë l∆∞·ª£ng m·ªõi (tƒÉng 1)
    dispatch(
      updateQuantity({
        id: item.id,                  // ID s·∫£n ph·∫©m c·∫ßn c·∫≠p nh·∫≠t
        quantity: item.quantity + 1,  // S·ªë l∆∞·ª£ng m·ªõi = s·ªë l∆∞·ª£ng c≈© + 1
      })
    );
    // Redux t·ª± ƒë·ªông:
    // 1. T√¨m item c√≥ id kh·ªõp
    // 2. C·∫≠p nh·∫≠t quantity
    // 3. C·∫≠p nh·∫≠t totalQuantity
    // 4. L∆∞u v√†o localStorage
    // 5. Component re-render
  };
  
  
  // ========================================
  // HANDLER: GI·∫¢M S·ªê L∆Ø·ª¢NG S·∫¢N PH·∫®M
  // ========================================
  const handleDecrease = (item) => {
    // N·∫øu quantity > 1 ‚Üí Gi·∫£m s·ªë l∆∞·ª£ng
    if (item.quantity > 1) {
      dispatch(
        updateQuantity({
          id: item.id,
          quantity: item.quantity - 1,  // Gi·∫£m 1
        })
      );
    } 
    // N·∫øu quantity = 1 ‚Üí X√≥a s·∫£n ph·∫©m kh·ªèi gi·ªè (kh√¥ng ƒë·ªÉ quantity = 0)
    else {
      dispatch(removeFromCart(item.id));
      // G·ª≠i action removeFromCart v·ªõi id s·∫£n ph·∫©m
    }
  };
  
  
  // ========================================
  // HANDLER: X√ìA S·∫¢N PH·∫®M
  // ========================================
  const handleRemove = (itemId) => {
    // Dispatch action removeFromCart
    dispatch(removeFromCart(itemId));
    // Redux t·ª± ƒë·ªông:
    // 1. L·ªçc b·ªè item c√≥ id = itemId
    // 2. C·∫≠p nh·∫≠t totalQuantity
    // 3. L∆∞u v√†o localStorage
    // 4. Component re-render
  };
  
  
  // ========================================
  // RENDER: TR∆Ø·ªúNG H·ª¢P GI·ªé H√ÄNG TR·ªêNG
  // ========================================
  if (cartItems.length === 0) {
    // N·∫øu m·∫£ng cartItems r·ªóng (kh√¥ng c√≥ s·∫£n ph·∫©m)
    return (
      <div className="cart-page">
        <div className="empty-cart">
          <img
            src="/icons/empty-cart.png"
            alt="Gi·ªè h√†ng tr·ªëng"
            onError={(e) => {
              // N·∫øu ·∫£nh l·ªói, thay b·∫±ng emoji
              e.target.style.display = "none";
              e.target.nextSibling.style.display = "block";
            }}
          />
          <div style={{ display: "none", fontSize: "80px" }}>üõí</div>
          <h2>Gi·ªè h√†ng tr·ªëng</h2>
          <p>H√£y th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng c·ªßa b·∫°n!</p>
          
          {/* Link quay v·ªÅ trang ch·ªß */}
          <Link to="/" className="back-to-home-btn">
            Ti·∫øp t·ª•c mua s·∫Øm
          </Link>
        </div>
      </div>
    );
  }
  
  
  // ========================================
  // RENDER: TR∆Ø·ªúNG H·ª¢P C√ì S·∫¢N PH·∫®M TRONG GI·ªé
  // ========================================
  return (
    <div className="cart-page">
      <div className="cart-container">
        
        {/* ===== DANH S√ÅCH S·∫¢N PH·∫®M ===== */}
        <div className="cart-items-section">
          <h2 className="cart-title">Gi·ªè h√†ng ({cartItems.length} s·∫£n ph·∫©m)</h2>
          
          {/* Duy·ªát qua t·∫•t c·∫£ s·∫£n ph·∫©m trong gi·ªè */}
          {cartItems.map((item) => (
            // key: React c·∫ßn key duy nh·∫•t cho m·ªói item trong list
            <div key={item.id} className="cart-item">
              
              {/* H√¨nh ·∫£nh s·∫£n ph·∫©m */}
              <div className="cart-item-image">
                <img src={item.image} alt={item.name} />
              </div>
              
              {/* Th√¥ng tin s·∫£n ph·∫©m */}
              <div className="cart-item-info">
                <h3>{item.name}</h3>
                
                {/* Hi·ªÉn th·ªã gi√° */}
                <div className="cart-item-price">
                  <span className="current-price">
                    {/* toLocaleString: Format s·ªë theo chu·∫©n Vi·ªát Nam (c√≥ d·∫•u ph·∫©y) */}
                    {item.price.toLocaleString("vi-VN")}‚Ç´
                  </span>
                  
                  {/* N·∫øu c√≥ gi√° g·ªëc (originalPrice), hi·ªÉn th·ªã v√† g·∫°ch ngang */}
                  {item.originalPrice && item.originalPrice > item.price && (
                    <span className="original-price">
                      {item.originalPrice.toLocaleString("vi-VN")}‚Ç´
                    </span>
                  )}
                </div>
              </div>
              
              {/* ƒêi·ªÅu khi·ªÉn s·ªë l∆∞·ª£ng */}
              <div className="cart-item-quantity">
                <div className="quantity-selector">
                  {/* N√∫t GI·∫¢M s·ªë l∆∞·ª£ng */}
                  <button
                    className="quantity-btn"
                    onClick={() => handleDecrease(item)}
                  >
                    -
                  </button>
                  
                  {/* Hi·ªÉn th·ªã s·ªë l∆∞·ª£ng hi·ªán t·∫°i */}
                  <span className="quantity-value">{item.quantity}</span>
                  
                  {/* N√∫t TƒÇNG s·ªë l∆∞·ª£ng */}
                  <button
                    className="quantity-btn"
                    onClick={() => handleIncrease(item)}
                  >
                    +
                  </button>
                </div>
              </div>
              
              {/* T·ªïng gi√° cho s·∫£n ph·∫©m n√†y */}
              <div className="cart-item-total">
                <span className="item-total-price">
                  {/* Gi√° √ó S·ªë l∆∞·ª£ng */}
                  {(item.price * item.quantity).toLocaleString("vi-VN")}‚Ç´
                </span>
              </div>
              
              {/* N√∫t X√ìA s·∫£n ph·∫©m */}
              <button
                className="remove-btn"
                onClick={() => handleRemove(item.id)}
                title="X√≥a s·∫£n ph·∫©m"
              >
                √ó
              </button>
            </div>
          ))}
        </div>
        
        
        {/* ===== T·ªîNG K·∫æT GI·ªé H√ÄNG ===== */}
        <div className="cart-summary">
          <h3>Th√¥ng tin ƒë∆°n h√†ng</h3>
          
          {/* T·ªïng s·ªë l∆∞·ª£ng s·∫£n ph·∫©m */}
          <div className="summary-row">
            <span>T·ªïng s·∫£n ph·∫©m:</span>
            <span>{cartItems.length}</span>
          </div>
          
          {/* T·ªïng ti·ªÅn (t·∫°m t√≠nh) */}
          <div className="summary-row total-row">
            <span>T·∫°m t√≠nh:</span>
            <span className="total-price">
              {totalPrice.toLocaleString("vi-VN")}‚Ç´
            </span>
          </div>
          
          {/* N√∫t thanh to√°n */}
          <button className="checkout-btn">
            Ti·∫øn h√†nh thanh to√°n
          </button>
          
          {/* Link ti·∫øp t·ª•c mua s·∫Øm */}
          <Link to="/" className="continue-shopping">
            ‚Üê Ti·∫øp t·ª•c mua s·∫Øm
          </Link>
        </div>
      </div>
    </div>
  );
}

export default CartPage;
```

### 5.4. Gi·∫£i th√≠ch lu·ªìng ho·∫°t ƒë·ªông

#### **Khi component load:**
```
1. useSelector ƒë·ªçc state.cart.items t·ª´ Redux
                ‚Üì
2. Ki·ªÉm tra cartItems.length
                ‚Üì
3a. N·∫øu = 0 ‚Üí Hi·ªÉn th·ªã "Gi·ªè h√†ng tr·ªëng"
3b. N·∫øu > 0 ‚Üí Hi·ªÉn th·ªã danh s√°ch s·∫£n ph·∫©m
```

#### **Khi user TƒÇNG s·ªë l∆∞·ª£ng:**
```
1. User click n√∫t "+"
                ‚Üì
2. handleIncrease(item) ƒë∆∞·ª£c g·ªçi
                ‚Üì
3. dispatch(updateQuantity({ id: 5, quantity: 4 }))
                ‚Üì
4. Redux reducer c·∫≠p nh·∫≠t item.quantity = 4
                ‚Üì
5. L∆∞u v√†o localStorage
                ‚Üì
6. useSelector ph√°t hi·ªán state thay ƒë·ªïi
                ‚Üì
7. Component re-render v·ªõi data m·ªõi
                ‚Üì
8. S·ªë l∆∞·ª£ng v√† t·ªïng ti·ªÅn t·ª± ƒë·ªông c·∫≠p nh·∫≠t
```

#### **Khi user X√ìA s·∫£n ph·∫©m:**
```
1. User click n√∫t "√ó"
                ‚Üì
2. handleRemove(itemId) ƒë∆∞·ª£c g·ªçi
                ‚Üì
3. dispatch(removeFromCart(itemId))
                ‚Üì
4. Redux reducer l·ªçc b·ªè item kh·ªèi m·∫£ng
                ‚Üì
5. L∆∞u v√†o localStorage
                ‚Üì
6. Component re-render
                ‚Üì
7. S·∫£n ph·∫©m bi·∫øn m·∫•t kh·ªèi giao di·ªán
```

### 5.5. ƒê·∫∑c ƒëi·ªÉm quan tr·ªçng

1. **T·ª± ƒë·ªông re-render:**
   - Kh√¥ng c·∫ßn `useState` hay `forceUpdate`
   - `useSelector` t·ª± ƒë·ªông subscribe v√†o Redux store
   - Khi state thay ƒë·ªïi ‚Üí Component re-render

2. **Single Source of Truth:**
   - T·∫•t c·∫£ data l·∫•y t·ª´ Redux (kh√¥ng duplicate state)
   - Kh√¥ng c·∫ßn truy·ªÅn props gi·ªØa components

3. **T√≠nh to√°n realtime:**
   - `totalPrice` ƒë∆∞·ª£c t√≠nh l·∫°i m·ªói l·∫ßn render
   - Lu√¥n ƒë·ªìng b·ªô v·ªõi cartItems

4. **Persistence:**
   - M·ªçi thay ƒë·ªïi ƒë·ªÅu t·ª± ƒë·ªông l∆∞u v√†o localStorage
   - F5 kh√¥ng m·∫•t d·ªØ li·ªáu

### 5.6. Th√™m route trong `src/App.jsx`

**CODE C·∫¨P NH·∫¨T:**

```javascript
// ============================================
// IMPORT CART PAGE
// ============================================
import CartPage from "./pages/CartPage";
// Import component CartPage


// ============================================
// TH√äM ROUTE CHO GI·ªé H√ÄNG
// ============================================
function App() {
  return (
    <BrowserRouter>
      <Routes>
        {/* Route trang ch·ªß */}
        <Route path="/" element={<HomePage />} />
        
        {/* Route chi ti·∫øt s·∫£n ph·∫©m */}
        <Route path="/product/:productId" element={<ProductDetailPage />} />
        
        {/* Route gi·ªè h√†ng - M·ªöI TH√äM */}
        <Route path="/cart" element={<CartPage />} />
        {/* 
          - URL: /cart
          - Component: CartPage
          - Khi user v√†o /cart ‚Üí Hi·ªÉn th·ªã gi·ªè h√†ng
        */}
      </Routes>
    </BrowserRouter>
  );
}
```

**Gi·∫£i th√≠ch:**
- `path="/cart"`: ƒê·ªãnh nghƒ©a URL path
- `element={<CartPage />}`: Component s·∫Ω render
- Khi user click v√†o icon gi·ªè h√†ng trong Header ‚Üí ƒêi·ªÅu h∆∞·ªõng ƒë·∫øn `/cart` ‚Üí Hi·ªÉn th·ªã CartPage

---

## B∆Ø·ªöC 6: C·∫¨P NH·∫¨T HEADER HI·ªÇN TH·ªä BADGE GI·ªé H√ÄNG

### 6.1. M·ªü file `src/components/Header/Header.jsx`

### 6.2. Th√™m import Redux

**CODE:**

```javascript
// ============================================
// IMPORT REDUX HOOK
// ============================================
import { useSelector } from "react-redux";
// useSelector: Hook ƒë·ªÉ ƒë·ªçc data t·ª´ Redux store

// Kh√¥ng c·∫ßn useDispatch v√¨ Header ch·ªâ ƒê·ªåC state, kh√¥ng G·ª¨I action
```

### 6.3. L·∫•y s·ªë l∆∞·ª£ng s·∫£n ph·∫©m trong gi·ªè

**CODE TRONG COMPONENT:**

```javascript
function Header() {
  // ========================================
  // L·∫§Y S·ªê L∆Ø·ª¢NG S·∫¢N PH·∫®M TRONG GI·ªé H√ÄNG
  // ========================================
  const cartItemsCount = useSelector((state) => state.cart.items.length);
  // cartItemsCount: S·ªë l∆∞·ª£ng S·∫¢N PH·∫®M KH√ÅC NHAU trong gi·ªè
  // L·∫•y t·ª´: state.cart.items.length
  
  // Component t·ª± ƒë·ªông re-render khi cartItemsCount thay ƒë·ªïi
  
  
  // ... ph·∫ßn code c√≤n l·∫°i c·ªßa Header
}
```

### 6.4. Ph√¢n bi·ªát `items.length` vs `totalQuantity`

**L∆ØU √ù QUAN TR·ªåNG:** D√πng `items.length` ch·ª© **KH√îNG** ph·∫£i `totalQuantity`

#### **Gi·∫£i th√≠ch s·ª± kh√°c bi·ªát:**

```javascript
// Gi·∫£ s·ª≠ gi·ªè h√†ng c√≥:
{
  items: [
    { id: 1, name: "iPhone", quantity: 5 },    // 1 s·∫£n ph·∫©m, s·ªë l∆∞·ª£ng 5
    { id: 2, name: "S√°ch", quantity: 3 },      // 1 s·∫£n ph·∫©m, s·ªë l∆∞·ª£ng 3
    { id: 3, name: "Tai nghe", quantity: 1 }   // 1 s·∫£n ph·∫©m, s·ªë l∆∞·ª£ng 1
  ],
  totalQuantity: 9  // 5 + 3 + 1 = 9
}

// ‚úì ƒê√öNG - D√πng items.length
state.cart.items.length  // = 3 (c√≥ 3 S·∫¢N PH·∫®M KH√ÅC NHAU)
‚Üí Badge hi·ªÉn th·ªã: 3

// ‚úó SAI - D√πng totalQuantity
state.cart.totalQuantity  // = 9 (t·ªïng S·ªê L∆Ø·ª¢NG)
‚Üí Badge hi·ªÉn th·ªã: 9 (G√ÇY HI·ªÇU NH·∫¶M!)
```

#### **T·∫°i sao ph·∫£i d√πng `items.length`?**
- Gi·ªëng Tiki, Shopee, Lazada ‚Üí Badge hi·ªÉn th·ªã s·ªë LO·∫†I s·∫£n ph·∫©m kh√°c nhau
- Kh√¥ng hi·ªÉn th·ªã t·ªïng s·ªë l∆∞·ª£ng (v√¨ c√≥ th·ªÉ r·∫•t l·ªõn v√† g√¢y hi·ªÉu nh·∫ßm)

**V√≠ d·ª• th·ª±c t·∫ø:**
```
Gi·ªè h√†ng c√≥:
- 1 iPhone (s·ªë l∆∞·ª£ng: 5)
- 1 S√°ch (s·ªë l∆∞·ª£ng: 3)

‚Üí Badge hi·ªÉn th·ªã: 2 ‚úì (2 s·∫£n ph·∫©m kh√°c nhau)
‚Üí KH√îNG hi·ªÉn th·ªã: 8 ‚úó (t·ªïng s·ªë l∆∞·ª£ng)
```

### 6.5. Hi·ªÉn th·ªã badge tr√™n icon gi·ªè h√†ng

**CODE TRONG JSX:**

```javascript
// ============================================
// ICON GI·ªé H√ÄNG V·ªöI BADGE
// ============================================
<Link to="/cart" className="cart-btn">
  {/* 
    Link: ƒêi·ªÅu h∆∞·ªõng ƒë·∫øn trang gi·ªè h√†ng (/cart)
    Kh√¥ng reload trang (SPA)
  */}
  
  {/* Icon gi·ªè h√†ng */}
  <div className="img-cart">
    <img src="/cart.png" alt="cart" />
  </div>
  
  {/* Badge hi·ªÉn th·ªã s·ªë l∆∞·ª£ng s·∫£n ph·∫©m */}
  <span className="cart-badge">{cartItemsCount}</span>
  {/* 
    - Lu√¥n hi·ªÉn th·ªã badge (k·ªÉ c·∫£ khi = 0)
    - Kh√¥ng c√≥ ƒëi·ªÅu ki·ªán if (cartItemsCount > 0)
    - Hi·ªÉn th·ªã 0 khi gi·ªè h√†ng tr·ªëng
  */}
</Link>
```

### 6.6. C√°c tr∆∞·ªùng h·ª£p hi·ªÉn th·ªã

| T√¨nh hu·ªëng | `items.length` | Badge hi·ªÉn th·ªã |
|-----------|---------------|----------------|
| Gi·ªè h√†ng tr·ªëng | 0 | **0** |
| 1 s·∫£n ph·∫©m (s·ªë l∆∞·ª£ng 5) | 1 | **1** |
| 3 s·∫£n ph·∫©m kh√°c nhau | 3 | **3** |
| 10 s·∫£n ph·∫©m kh√°c nhau | 10 | **10** |

### 6.7. Lu·ªìng c·∫≠p nh·∫≠t badge

```
1. User th√™m s·∫£n ph·∫©m v√†o gi·ªè (·ªü ProductDetailPage)
                ‚Üì
2. dispatch(addToCart({...}))
                ‚Üì
3. Redux reducer c·∫≠p nh·∫≠t state.cart.items
                ‚Üì
4. state.cart.items.length thay ƒë·ªïi
                ‚Üì
5. useSelector ph√°t hi·ªán thay ƒë·ªïi
                ‚Üì
6. Header component T·ª∞ ƒê·ªòNG re-render
                ‚Üì
7. Badge c·∫≠p nh·∫≠t v·ªõi gi√° tr·ªã m·ªõi
```

**V√≠ d·ª• chi ti·∫øt:**
```
Gi·ªè h√†ng ban ƒë·∫ßu: items = []
‚Üí Badge: 0

User th√™m iPhone:
‚Üí items = [{id:1, name:"iPhone", ...}]
‚Üí items.length = 1
‚Üí Badge t·ª± ƒë·ªông c·∫≠p nh·∫≠t: 1

User th√™m S√°ch:
‚Üí items = [{id:1, ...}, {id:5, ...}]
‚Üí items.length = 2
‚Üí Badge t·ª± ƒë·ªông c·∫≠p nh·∫≠t: 2

User th√™m iPhone l·∫ßn 2 (tr√πng):
‚Üí items = [{id:1, quantity:2}, {id:5, ...}]
‚Üí items.length = 2 (v·∫´n 2 s·∫£n ph·∫©m kh√°c nhau)
‚Üí Badge v·∫´n: 2 (KH√îNG thay ƒë·ªïi)
```

### 6.8. Styling CSS cho badge

**Trong `Header.css`:**

```css
.cart-badge {
  position: absolute;           /* ƒê·ªãnh v·ªã tuy·ªát ƒë·ªëi */
  top: -8px;                    /* ƒê·∫∑t ·ªü g√≥c tr√™n b√™n ph·∫£i */
  right: -8px;
  
  background-color: #ff424e;    /* M√†u ƒë·ªè n·ªïi b·∫≠t */
  color: white;                 /* Ch·ªØ tr·∫Øng */
  
  min-width: 20px;              /* Chi·ªÅu r·ªông t·ªëi thi·ªÉu */
  height: 20px;                 /* Chi·ªÅu cao c·ªë ƒë·ªãnh */
  
  border-radius: 50%;           /* H√¨nh tr√≤n */
  
  display: flex;                /* Flexbox ƒë·ªÉ cƒÉn gi·ªØa */
  align-items: center;          /* CƒÉn gi·ªØa theo chi·ªÅu d·ªçc */
  justify-content: center;      /* CƒÉn gi·ªØa theo chi·ªÅu ngang */
  
  font-size: 12px;              /* C·ª° ch·ªØ nh·ªè */
  font-weight: bold;            /* Ch·ªØ ƒë·∫≠m */
  
  padding: 0 4px;               /* Padding ngang */
}

/* Khi s·ªë l∆∞·ª£ng >= 100, badge r·ªông h∆°n */
.cart-badge {
  min-width: 20px;
  padding: 0 5px;
}
```

---

## B∆Ø·ªöC 7: LOCALSTORAGE PERSISTENCE (L∆∞u tr·ªØ gi·ªè h√†ng)

### 7.1. V·∫•n ƒë·ªÅ c·∫ßn gi·∫£i quy·∫øt

**V·∫•n ƒë·ªÅ:**
```
1. User th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng
2. User refresh trang (F5)
3. Redux state b·ªã RESET v·ªÅ ban ƒë·∫ßu
4. Gi·ªè h√†ng B·ªä M·∫§T H·∫æT! ‚ùå
```

**Nguy√™n nh√¢n:**
- Redux state ch·ªâ t·ªìn t·∫°i trong **memory (RAM)**
- Khi refresh ‚Üí Trang load l·∫°i ‚Üí State b·ªã kh·ªüi t·∫°o l·∫°i
- Kh√¥ng c√≥ c∆° ch·∫ø l∆∞u tr·ªØ l√¢u d√†i

### 7.2. Gi·∫£i ph√°p: L∆∞u v√†o localStorage

**localStorage l√† g√¨?**
- API c·ªßa tr√¨nh duy·ªát ƒë·ªÉ l∆∞u d·ªØ li·ªáu d·∫°ng **key-value**
- D·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u **vƒ©nh vi·ªÖn** (kh√¥ng t·ª± ƒë·ªông x√≥a)
- Ch·ªâ l∆∞u ƒë∆∞·ª£c **string** (ph·∫£i convert object ‚Üí JSON string)

### 7.3. Function LOAD gi·ªè h√†ng t·ª´ localStorage

**CODE ƒê√É TH√äM TRONG `cartSlice.js`:**

```javascript
// ============================================
// FUNCTION LOAD GI·ªé H√ÄNG T·ª™ LOCALSTORAGE
// ============================================
const loadCartFromStorage = () => {
  try {
    // B∆Ø·ªöC 1: ƒê·ªåC D·ªÆ LI·ªÜU T·ª™ LOCALSTORAGE
    const savedCart = localStorage.getItem("tikiCart");
    // getItem("tikiCart"): ƒê·ªçc d·ªØ li·ªáu v·ªõi key "tikiCart"
    // Tr·∫£ v·ªÅ: string (JSON) ho·∫∑c null (n·∫øu ch∆∞a c√≥ data)
    
    // B∆Ø·ªöC 2: KI·ªÇM TRA V√Ä PARSE JSON
    if (savedCart) {
      // N·∫øu c√≥ d·ªØ li·ªáu ‚Üí Parse JSON string th√†nh object
      return JSON.parse(savedCart);
      // V√≠ d·ª•:
      //   Input: '{"items":[...],"totalQuantity":3}'
      //   Output: { items: [...], totalQuantity: 3 }
    }
    
  } catch (error) {
    // X·ª¨ L√ù L·ªñI n·∫øu JSON kh√¥ng h·ª£p l·ªá
    console.error("Error loading cart from localStorage:", error);
  }
  
  // B∆Ø·ªöC 3: TR·∫¢ V·ªÄ STATE M·∫∂C ƒê·ªäNH n·∫øu ch∆∞a c√≥ data
  return {
    items: [],           // M·∫£ng s·∫£n ph·∫©m r·ªóng
    totalQuantity: 0,    // T·ªïng = 0
  };
};
```

**Gi·∫£i th√≠ch t·ª´ng tr∆∞·ªùng h·ª£p:**

| Tr∆∞·ªùng h·ª£p | `savedCart` | K·∫øt qu·∫£ |
|-----------|-------------|---------|
| L·∫ßn ƒë·∫ßu ch·∫°y app | `null` | `{ items: [], totalQuantity: 0 }` |
| ƒê√£ l∆∞u data | `'{"items":[...]}'` | Parse ‚Üí object |
| JSON l·ªói | `'{invalid}'` | Catch error ‚Üí state m·∫∑c ƒë·ªãnh |

### 7.4. Function L∆ØU gi·ªè h√†ng v√†o localStorage

**CODE:**

```javascript
// ============================================
// FUNCTION L∆ØU GI·ªé H√ÄNG V√ÄO LOCALSTORAGE
// ============================================
const saveCartToStorage = (state) => {
  // state: Redux state hi·ªán t·∫°i
  // V√≠ d·ª•: { items: [...], totalQuantity: 5 }
  
  try {
    // B∆Ø·ªöC 1: CHUY·ªÇN OBJECT ‚Üí JSON STRING
    const jsonString = JSON.stringify(state);
    // V√≠ d·ª•:
    //   Input: { items: [{id:1}], totalQuantity: 1 }
    //   Output: '{"items":[{"id":1}],"totalQuantity":1}'
    
    // B∆Ø·ªöC 2: L∆ØU V√ÄO LOCALSTORAGE
    localStorage.setItem("tikiCart", jsonString);
    // Key: "tikiCart"
    // Value: JSON string
    // D·ªØ li·ªáu l∆∞u vƒ©nh vi·ªÖn trong browser
    
  } catch (error) {
    // X·ª¨ L√ù L·ªñI (localStorage ƒë·∫ßy, privacy mode, etc.)
    console.error("Error saving cart to localStorage:", error);
  }
};
```

### 7.5. T√≠ch h·ª£p v√†o Redux Slice

**CODE:**

```javascript
const cartSlice = createSlice({
  name: "cart",
  
  // KH·ªûI T·∫†O STATE T·ª™ LOCALSTORAGE
  initialState: loadCartFromStorage(),
  // Thay v√¨: { items: [], totalQuantity: 0 }
  // ‚Üí G·ªçi loadCartFromStorage() ƒë·ªÉ load data ƒë√£ l∆∞u
  
  reducers: {
    addToCart: (state, action) => {
      // ... logic th√™m s·∫£n ph·∫©m ...
      
      // L∆ØU V√ÄO LOCALSTORAGE SAU KHI C·∫¨P NH·∫¨T
      saveCartToStorage(state);
    },
    
    removeFromCart: (state, action) => {
      // ... logic x√≥a ...
      saveCartToStorage(state);  // L∆∞u
    },
    
    updateQuantity: (state, action) => {
      // ... logic c·∫≠p nh·∫≠t ...
      saveCartToStorage(state);  // L∆∞u
    },
    
    clearCart: (state) => {
      state.items = [];
      state.totalQuantity = 0;
      saveCartToStorage(state);  // L∆∞u state r·ªóng
    },
  },
});
```

### 7.6. Lu·ªìng ho·∫°t ƒë·ªông LOAD (Kh√¥i ph·ª•c gi·ªè h√†ng)

```
APP KH·ªûI ƒê·ªòNG
      ‚Üì
1. Redux store ƒë∆∞·ª£c t·∫°o
      ‚Üì
2. initialState: loadCartFromStorage() ƒë∆∞·ª£c g·ªçi
      ‚Üì
3. loadCartFromStorage() ƒë·ªçc localStorage.getItem("tikiCart")
      ‚Üì
4a. N·∫øu c√≥ data ‚Üí JSON.parse() ‚Üí Return object
4b. N·∫øu kh√¥ng c√≥ ‚Üí Return { items: [], totalQuantity: 0 }
      ‚Üì
5. Redux state ƒë∆∞·ª£c kh·ªüi t·∫°o v·ªõi data t·ª´ localStorage
      ‚Üì
6. Components render v·ªõi d·ªØ li·ªáu ƒë√£ l∆∞u
      ‚Üì
‚úÖ GI·ªé H√ÄNG HI·ªÇN TH·ªä ƒê√öNG D·ªÆ LI·ªÜU ƒê√É L∆ØU
```

### 7.7. Lu·ªìng ho·∫°t ƒë·ªông SAVE (L∆∞u gi·ªè h√†ng)

```
USER TH√äM S·∫¢N PH·∫®M V√ÄO GI·ªé
      ‚Üì
1. dispatch(addToCart({...}))
      ‚Üì
2. Redux reducer x·ª≠ l√Ω ‚Üí C·∫≠p nh·∫≠t state
      ‚Üì
3. saveCartToStorage(state) ƒë∆∞·ª£c g·ªçi
      ‚Üì
4. JSON.stringify(state) ‚Üí Chuy·ªÉn object th√†nh string
      ‚Üì
5. localStorage.setItem("tikiCart", jsonString)
      ‚Üì
‚úÖ D·ªÆ LI·ªÜU ƒê√É ƒê∆Ø·ª¢C L∆ØU V√ÄO BROWSER

USER REFRESH TRANG (F5)
      ‚Üì
‚Üí Quay l·∫°i lu·ªìng LOAD ·ªü tr√™n
      ‚Üì
‚úÖ GI·ªé H√ÄNG V·∫™N C√íN!
```

### 7.8. K·∫øt qu·∫£ ƒë·∫°t ƒë∆∞·ª£c

| H√†nh ƒë·ªông | Tr∆∞·ªõc (Kh√¥ng localStorage) | Sau (C√≥ localStorage) |
|-----------|---------------------------|----------------------|
| **F5 (Refresh)** | ‚ùå M·∫•t h·∫øt | ‚úÖ V·∫´n c√≤n |
| **ƒê√≥ng tab ‚Üí M·ªü l·∫°i** | ‚ùå M·∫•t h·∫øt | ‚úÖ V·∫´n c√≤n |
| **T·∫Øt browser ‚Üí M·ªü l·∫°i** | ‚ùå M·∫•t h·∫øt | ‚úÖ V·∫´n c√≤n |
| **Sang ng√†y h√¥m sau** | ‚ùå M·∫•t h·∫øt | ‚úÖ V·∫´n c√≤n |

---

## KI·∫æN TR√öC T·ªîNG TH·ªÇ

### Flow Diagram:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        USER ACTIONS                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    REACT COMPONENTS                          ‚îÇ
‚îÇ  - ProductDetailPage: Click "Th√™m v√†o gi·ªè"                  ‚îÇ
‚îÇ  - CartPage: TƒÉng/Gi·∫£m/X√≥a s·∫£n ph·∫©m                         ‚îÇ
‚îÇ  - Header: Hi·ªÉn th·ªã badge s·ªë l∆∞·ª£ng                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                              ‚îÇ dispatch(action)
                              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      REDUX ACTIONS                           ‚îÇ
‚îÇ  - addToCart({ id, name, price, quantity, ... })            ‚îÇ
‚îÇ  - removeFromCart(id)                                        ‚îÇ
‚îÇ  - updateQuantity({ id, quantity })                          ‚îÇ
‚îÇ  - clearCart()                                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                              ‚îÇ reducer x·ª≠ l√Ω
                              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     REDUX STORE (STATE)                      ‚îÇ
‚îÇ  {                                                           ‚îÇ
‚îÇ    cart: {                                                   ‚îÇ
‚îÇ      items: [                                                ‚îÇ
‚îÇ        { id: 1, name: "...", price: 100000, quantity: 2 }   ‚îÇ
‚îÇ      ],                                                      ‚îÇ
‚îÇ      totalQuantity: 2                                        ‚îÇ
‚îÇ    }                                                         ‚îÇ
‚îÇ  }                                                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                              ‚îÇ saveCartToStorage()
                              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      LOCALSTORAGE                            ‚îÇ
‚îÇ  Key: "tikiCart"                                             ‚îÇ
‚îÇ  Value: JSON.stringify(state)                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                              ‚îÇ loadCartFromStorage()
                              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    KH√îI PH·ª§C KHI F5                          ‚îÇ
‚îÇ  - Load t·ª´ localStorage                                      ‚îÇ
‚îÇ  - Parse JSON ‚Üí Object                                       ‚îÇ
‚îÇ  - Set l√†m initialState                                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                              ‚îÇ useSelector()
                              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                COMPONENTS RE-RENDER                          ‚îÇ
‚îÇ  - Header badge c·∫≠p nh·∫≠t                                     ‚îÇ
‚îÇ  - CartPage hi·ªÉn th·ªã danh s√°ch                              ‚îÇ
‚îÇ  - UI t·ª± ƒë·ªông sync v·ªõi state                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## C√ÅC FILE ƒê√É T·∫†O/S·ª¨A

### T·∫°o m·ªõi:
1. `src/store/cartSlice.js` - Redux slice cho gi·ªè h√†ng
2. `src/store/store.js` - Redux store configuration
3. `src/pages/CartPage.jsx` - Trang gi·ªè h√†ng
4. `src/pages/CartPage.css` - CSS cho trang gi·ªè h√†ng

### Ch·ªânh s·ª≠a:
1. `src/index.js` - Th√™m Redux Provider
2. `src/App.jsx` - Th√™m route `/cart`
3. `src/pages/ProductDetailPage.jsx` - Th√™m ch·ª©c nƒÉng "Th√™m v√†o gi·ªè"
4. `src/components/Header/Header.jsx` - Hi·ªÉn th·ªã badge s·ªë l∆∞·ª£ng

---

## T√ìM T·∫ÆT T·ª™NG B∆Ø·ªöC TH·ª∞C HI·ªÜN

### üìã **B∆Ø·ªöC 1: C√†i ƒë·∫∑t Redux Toolkit**
```bash
cd tiki-clone
npm install @reduxjs/toolkit react-redux
```

### üìã **B∆Ø·ªöC 2.1: T·∫°o Cart Slice**
1. T·∫°o th∆∞ m·ª•c: `src/store/`
2. T·∫°o file: `src/store/cartSlice.js`
3. Code:
   - Function `loadCartFromStorage()`
   - Function `saveCartToStorage()`
   - `createSlice` v·ªõi 4 reducers
   - Export actions v√† reducer

### üìã **B∆Ø·ªöC 2.2: T·∫°o Store**
1. T·∫°o file: `src/store/store.js`
2. Code:
   - Import `configureStore` v√† `cartReducer`
   - T·∫°o store v·ªõi `reducer: { cart: cartReducer }`
   - Export store

### üìã **B∆Ø·ªöC 3: Setup Provider**
1. M·ªü file: `src/index.js`
2. S·ª≠a:
   - Import `Provider` v√† `store`
   - B·ªçc `<App />` v·ªõi `<Provider store={store}>`

### üìã **B∆Ø·ªöC 4: T·∫°o Product Detail Page**
1. T·∫°o file: `src/pages/ProductDetailPage.jsx`
2. T·∫°o file: `src/pages/ProductDetailPage.css`
3. Code:
   - Import hooks, actions, data sources
   - Function `findProduct()` t√¨m t·ª´ nhi·ªÅu data sources
   - Quantity selector
   - N√∫t "Th√™m v√†o gi·ªè" v·ªõi dispatch
   - Notification popup

### üìã **B∆Ø·ªöC 5: T·∫°o Cart Page**
1. T·∫°o file: `src/pages/CartPage.jsx`
2. T·∫°o file: `src/pages/CartPage.css`
3. Code:
   - `useSelector` l·∫•y cartItems
   - Handlers: increase, decrease, remove
   - Render danh s√°ch v·ªõi `.map()`
   - Empty cart state
4. C·∫≠p nh·∫≠t: `src/App.jsx` th√™m route `/cart`

### üìã **B∆Ø·ªöC 6: C·∫≠p nh·∫≠t Header Badge**
1. M·ªü file: `src/components/Header/Header.jsx`
2. S·ª≠a:
   - Import `useSelector`
   - L·∫•y `cartItemsCount = state.cart.items.length`
   - Hi·ªÉn th·ªã badge lu√¥n (k·ªÉ c·∫£ = 0)

### üìã **B∆Ø·ªöC 7: Fix l·ªói product ID**
1. M·ªü file: `src/components/SuggestedProducts/SuggestedProducts.jsx`
2. S·ª≠a:
   - ƒê·ªïi `id: i + 1` ‚Üí `displayKey: i + 1`
   - ƒê·ªïi `key={product.id}` ‚Üí `key={product.displayKey}`

---

## TESTING CHECKLIST

### ‚úÖ Th√™m s·∫£n ph·∫©m:
- [ ] Click "Th√™m v√†o gi·ªè" ‚Üí Badge tƒÉng l√™n
- [ ] Th√™m s·∫£n ph·∫©m tr√πng ‚Üí S·ªë l∆∞·ª£ng tƒÉng, kh√¥ng t·∫°o item m·ªõi
- [ ] Th√™m nhi·ªÅu s·∫£n ph·∫©m kh√°c nhau ‚Üí Badge hi·ªÉn th·ªã s·ªë l∆∞·ª£ng item

### ‚úÖ Trang gi·ªè h√†ng:
- [ ] Hi·ªÉn th·ªã ƒë√∫ng danh s√°ch s·∫£n ph·∫©m
- [ ] TƒÉng s·ªë l∆∞·ª£ng ‚Üí T·ªïng ti·ªÅn c·∫≠p nh·∫≠t
- [ ] Gi·∫£m s·ªë l∆∞·ª£ng (t·ªëi thi·ªÉu 1)
- [ ] X√≥a s·∫£n ph·∫©m ‚Üí Item b·ªã lo·∫°i b·ªè
- [ ] Ch·ªçn/b·ªè ch·ªçn ‚Üí T·ªïng ti·ªÅn thay ƒë·ªïi

### ‚úÖ LocalStorage:
- [ ] F5 trang ‚Üí Gi·ªè h√†ng kh√¥ng m·∫•t
- [ ] ƒê√≥ng tr√¨nh duy·ªát ‚Üí M·ªü l·∫°i v·∫´n c√≤n
- [ ] X√≥a s·∫£n ph·∫©m ‚Üí F5 ‚Üí S·∫£n ph·∫©m kh√¥ng xu·∫•t hi·ªán l·∫°i

### ‚úÖ Header badge:
- [ ] Gi·ªè tr·ªëng ‚Üí Badge: 0
- [ ] 1 s·∫£n ph·∫©m s·ªë l∆∞·ª£ng 5 ‚Üí Badge: 1
- [ ] 3 s·∫£n ph·∫©m kh√°c nhau ‚Üí Badge: 3

---

## DEBUGGING TIPS

### Xem Redux State:
```javascript
// Trong React component
const state = useSelector((state) => state);
console.log("Redux State:", state);
```

### Xem localStorage:
```javascript
// Trong Browser Console
localStorage.getItem("tikiCart");

// Ho·∫∑c: DevTools ‚Üí Application ‚Üí Local Storage
```

### Redux DevTools:
C√†i extension **Redux DevTools** ƒë·ªÉ xem:
- State hi·ªán t·∫°i
- L·ªãch s·ª≠ c√°c actions
- Time-travel debugging

---

## K·∫æT LU·∫¨N

Ch·ª©c nƒÉng gi·ªè h√†ng ƒë√£ ho√†n th√†nh v·ªõi ƒë·∫ßy ƒë·ªß t√≠nh nƒÉng:
- ‚úÖ Redux state management
- ‚úÖ LocalStorage persistence
- ‚úÖ UI/UX gi·ªëng Tiki
- ‚úÖ T·ª± ƒë·ªông c·ªông d·ªìn s·∫£n ph·∫©m tr√πng
- ‚úÖ Badge hi·ªÉn th·ªã s·ªë l∆∞·ª£ng s·∫£n ph·∫©m kh√°c nhau
- ‚úÖ Kh√¥ng m·∫•t data khi F5

**C√°c c√¥ng ngh·ªá s·ª≠ d·ª•ng:**
- React Hooks (useState, useSelector, useDispatch)
- Redux Toolkit (@reduxjs/toolkit)
- React Redux (react-redux)
- Browser LocalStorage API
- React Router (routing)

---

## T√ÄI LI·ªÜU THAM KH·∫¢O

- Redux Toolkit: https://redux-toolkit.js.org/
- React Redux: https://react-redux.js.org/
- Redux DevTools: https://github.com/reduxjs/redux-devtools

